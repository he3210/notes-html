<!DOCTYPE html>
<html lang="zh-CN">
<head>
<!-- 2021-08-20 Fri 15:39 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>&lrm;</title>
<meta name="generator" content="Org mode">
<meta name="author" content="时中贺">
<link rel="stylesheet" type="text/css" href="http://www.langdebuqing.com/css/style.css" />
<link rel="shortcut icon" href="http://www.langdebuqing.com/images/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="preamble" class="status">
<div id="navbar">
    <ul>
        <li id="site-master"><a href="http://www.langdebuqing.com">浪的不轻</a></li>
        <li><a class="navbar-item" href="http://www.langdebuqing.com/gallery.html">Gallery</a> </li>
        <li><a class="navbar-item" href="http://www.langdebuqing.com/notebooks.html">Notebooks</a> </li>
        <li><a class="navbar-item" href="http://www.langdebuqing.com/links.html">Links</a> </li>
        <li><a class="navbar-item" href="http://www.langdebuqing.com/about.html">About</a> </li>
        <li class="search">
            <form action="http://google.com/search" method="get" accept-charset="utf-8">
                <input type="search" id="search" name="q" autocomplete="off" maxlength="30" placeholder="Google..">
                <input type="hidden" name="q" value="site:www.langdebuqing.com">
            </form>
        </li>
    </ul>
</div>
</div>
<div id="content">
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org1bc88d2">1. http 接口</a>
<ul>
<li><a href="#org06d32d1">1.1. 获取奖励信息接口</a></li>
<li><a href="#org328e231">1.2. 奖励领取接口</a></li>
<li><a href="#org7318c5a">1.3. 发信接口</a></li>
<li><a href="#orgc73adc9">1.4. 获取优秀来信</a></li>
<li><a href="#org1ca12a4">1.5. 获取直播间邮件列表</a></li>
<li><a href="#orgecf178e">1.6. 查看指定邮件接口</a></li>
<li><a href="#org674b20d">1.7. 是否公开信件接口</a></li>
<li><a href="#org3754d2a">1.8. 获取最近正在进行中的的活动的未读邮件数量</a></li>
</ul>
</li>
<li><a href="#org249fac0">2. 运营后台</a></li>
<li><a href="#orgf0dd762">3. 主播在直播间分享邮件后，在直播间发一条消息，用户点击可读取邮件</a></li>
<li><a href="#org93f9249">4. 活动期间每日弹窗提示</a></li>
<li><a href="#orgfb2b213">5. 主播收信 WEB_EVENT，写信 WEB_EVENT</a></li>
<li><a href="#org0b55e22">6. 私信</a></li>
<li><a href="#org3473266">7. 数据结构</a>
<ul>
<li><a href="#orgf6f68c7">7.1. event_emails</a></li>
<li><a href="#org43867eb">7.2. event_awards</a></li>
</ul>
</li>
<li><a href="#org9f2f9ab">8. api</a>
<ul>
<li><a href="#orgf7c3441">8.1. 获取我的奖励领取状态 def get_my_award_status(event_name, uid, group_id_list)</a></li>
<li><a href="#org94e2976">8.2. 领取我的奖励  def get_award_by_group_id(event_name, uid, group_id)</a></li>
<li><a href="#org3f43394">8.3. 获取优秀信件列表 def get_email_examples(event_name, refresh=False)</a></li>
<li><a href="#org81368f5">8.4. 获取该活动中我收到的所有邮件 def get_my_total_emails(event_name, uid, refresh=False)</a></li>
<li><a href="#org4dba277">8.5. 获取邮件详情 def get_the_email_info(email_id, refresh=False)</a></li>
<li><a href="#org35462b2">8.6. 获取未读邮件数量</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
+TITLE: white day 2020<br>
</p>

<div id="outline-container-org1bc88d2" class="outline-2">
<h2 id="org1bc88d2"><span class="section-number-2">1</span> http 接口</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org06d32d1" class="outline-3">
<h3 id="org06d32d1"><span class="section-number-3">1.1</span> 获取奖励信息接口</h3>
</div>
<div id="outline-container-org328e231" class="outline-3">
<h3 id="org328e231"><span class="section-number-3">1.2</span> 奖励领取接口</h3>
</div>
<div id="outline-container-org7318c5a" class="outline-3">
<h3 id="org7318c5a"><span class="section-number-3">1.3</span> 发信接口</h3>
</div>
<div id="outline-container-orgc73adc9" class="outline-3">
<h3 id="orgc73adc9"><span class="section-number-3">1.4</span> 获取优秀来信</h3>
</div>
<div id="outline-container-org1ca12a4" class="outline-3">
<h3 id="org1ca12a4"><span class="section-number-3">1.5</span> 获取直播间邮件列表</h3>
</div>
<div id="outline-container-orgecf178e" class="outline-3">
<h3 id="orgecf178e"><span class="section-number-3">1.6</span> 查看指定邮件接口</h3>
</div>
<div id="outline-container-org674b20d" class="outline-3">
<h3 id="org674b20d"><span class="section-number-3">1.7</span> 是否公开信件接口</h3>
</div>

<div id="outline-container-org3754d2a" class="outline-3">
<h3 id="org3754d2a"><span class="section-number-3">1.8</span> 获取最近正在进行中的的活动的未读邮件数量</h3>
</div>
</div>
<div id="outline-container-org249fac0" class="outline-2">
<h2 id="org249fac0"><span class="section-number-2">2</span> 运营后台</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>信件后台。优秀信件挑选<br></li>
</ul>
</div>
</div>

<div id="outline-container-orgf0dd762" class="outline-2">
<h2 id="orgf0dd762"><span class="section-number-2">3</span> 主播在直播间分享邮件后，在直播间发一条消息，用户点击可读取邮件</h2>
</div>
<div id="outline-container-org93f9249" class="outline-2">
<h2 id="org93f9249"><span class="section-number-2">4</span> 活动期间每日弹窗提示</h2>
</div>
<div id="outline-container-orgfb2b213" class="outline-2">
<h2 id="orgfb2b213"><span class="section-number-2">5</span> 主播收信 WEB_EVENT，写信 WEB_EVENT</h2>
</div>
<div id="outline-container-org0b55e22" class="outline-2">
<h2 id="org0b55e22"><span class="section-number-2">6</span> 私信</h2>
</div>

<div id="outline-container-org3473266" class="outline-2">
<h2 id="org3473266"><span class="section-number-2">7</span> 数据结构</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orgf6f68c7" class="outline-3">
<h3 id="orgf6f68c7"><span class="section-number-3">7.1</span> event_emails</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #5f8700;">CREATE</span> <span style="color: #5f8700;">TABLE</span> `event_emails` (
`id` <span style="color: #af8700;">int</span>(10) unsigned <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> AUTO_INCREMENT COMMENT <span style="color: #00afaf;">'&#21807;&#19968;&#26631;&#35782;&#19968;&#20010;&#37038;&#20214;'</span>,
`uid` <span style="color: #af8700;">varchar</span>(32) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span>,
`t_uid` <span style="color: #af8700;">varchar</span>(32) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span>,
`event_name` <span style="color: #af8700;">varchar</span>(40) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #00afaf;">''</span>,
`title` <span style="color: #af8700;">varchar</span>(64) <span style="color: #af8700;">CHARACTER</span> <span style="color: #5f8700;">SET</span> utf8mb4 <span style="color: #5f8700;">COLLATE</span> utf8mb4_bin <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #00afaf;">''</span> COMMENT <span style="color: #00afaf;">'&#37038;&#20214;&#26631;&#39064;'</span>,
`content` <span style="color: #af8700;">varchar</span>(8192) <span style="color: #af8700;">CHARACTER</span> <span style="color: #5f8700;">SET</span> utf8mb4 <span style="color: #5f8700;">COLLATE</span> utf8mb4_bin <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #00afaf;">''</span> COMMENT <span style="color: #00afaf;">'&#37038;&#20214;&#20869;&#23481;'</span>,
`read_time` datetime,
`is_public` tinyint(4) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #00afaf;">'0'</span> COMMENT <span style="color: #00afaf;">'1-&#21457;&#20449;&#32773;&#20801;&#35768;&#20027;&#25773;&#20844;&#24320;&#20449;&#20214; 0-&#19981;&#20801;&#35768;&#20844;&#24320;&#20449;&#20214;'</span>,
`is_anonymous` tinyint(4) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #00afaf;">'1'</span> COMMENT <span style="color: #00afaf;">'1-&#21311;&#21517;&#21457;&#20449; 0-&#19981;&#21311;'</span>,
`is_example` tinyint(4) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #00afaf;">'0'</span> COMMENT <span style="color: #00afaf;">'1-&#20248;&#31168;&#20449;&#20214;&#65292;&#34987;&#36816;&#33829;&#25361;&#36873;&#29992;&#20110;&#23637;&#31034; 0-&#24120;&#35268;&#20449;&#20214;'</span>,
`is_enabled` tinyint(4) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #00afaf;">'1'</span>,
`ctime` datetime <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span>,
`mtime` <span style="color: #af8700;">timestamp</span> <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #5f8700;">CURRENT_TIMESTAMP</span> <span style="color: #5f8700;">ON</span> <span style="color: #5f8700;">UPDATE</span> <span style="color: #5f8700;">CURRENT_TIMESTAMP</span>,
<span style="color: #5f8700;">PRIMARY</span> <span style="color: #5f8700;">KEY</span> (`id`),
<span style="color: #5f8700;">KEY</span> `idx_event_name_t_uid` (`event_name`, `t_uid`)
) ENGINE = InnoDB AUTO_INCREMENT = 1 <span style="color: #5f8700;">DEFAULT</span> CHARSET = utf8mb4 COMMENT=<span style="color: #00afaf;">'&#27963;&#21160;&#30452;&#25773;&#38388;&#37038;&#20214;&#34920;'</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-org43867eb" class="outline-3">
<h3 id="org43867eb"><span class="section-number-3">7.2</span> event_awards</h3>
<div class="outline-text-3" id="text-7-2">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #5f8700;">CREATE</span> <span style="color: #5f8700;">TABLE</span> `event_awards` (
`id` <span style="color: #af8700;">int</span>(10) unsigned <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> AUTO_INCREMENT COMMENT <span style="color: #00afaf;">'&#33258;&#22686;&#23383;&#27573;'</span>,
`uid` <span style="color: #af8700;">varchar</span>(32) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span>,
`event_name` <span style="color: #af8700;">varchar</span>(40) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #00afaf;">''</span>,
`group_id` <span style="color: #af8700;">int</span>(10) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> COMMENT <span style="color: #00afaf;">'&#35813;&#32452;&#22870;&#21697;&#30340;&#32452;id'</span>,
`is_received` tinyint(4) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #00afaf;">'0'</span> COMMENT <span style="color: #00afaf;">'0-&#26410;&#39046;&#21462; 1-&#24050;&#39046;&#21462;'</span>,
`is_enabled` tinyint(4) <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #00afaf;">'1'</span>,
`ctime` datetime <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span>,
`mtime` <span style="color: #af8700;">timestamp</span> <span style="color: #5f8700;">NOT</span> <span style="color: #5f8700;">NULL</span> <span style="color: #5f8700;">DEFAULT</span> <span style="color: #5f8700;">CURRENT_TIMESTAMP</span> <span style="color: #5f8700;">ON</span> <span style="color: #5f8700;">UPDATE</span> <span style="color: #5f8700;">CURRENT_TIMESTAMP</span>,
<span style="color: #5f8700;">PRIMARY</span> <span style="color: #5f8700;">KEY</span> (`id`),
<span style="color: #5f8700;">UNIQUE</span> <span style="color: #5f8700;">KEY</span> `uniq_event_name_uid_group_id` (`event_name`, `uid`, `group_id`)
) ENGINE = InnoDB AUTO_INCREMENT = 1 <span style="color: #5f8700;">DEFAULT</span> CHARSET = utf8mb4 COMMENT=<span style="color: #00afaf;">'&#27963;&#21160;&#33719;&#22870;&#34920;'</span>;
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9f2f9ab" class="outline-2">
<h2 id="org9f2f9ab"><span class="section-number-2">8</span> api</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orgf7c3441" class="outline-3">
<h3 id="orgf7c3441"><span class="section-number-3">8.1</span> 获取我的奖励领取状态 def get_my_award_status(event_name, uid, group_id_list)</h3>
<div class="outline-text-3" id="text-8-1">
<ul class="org-ul">
<li>EVENT_AWARD_FORMAT<br></li>
<li>返回一个列表，和 group_id_list 一一对应。-1 表示未达成领取条件 0-待领取 1-已领取<br></li>
</ul>
</div>
</div>
<div id="outline-container-org94e2976" class="outline-3">
<h3 id="org94e2976"><span class="section-number-3">8.2</span> 领取我的奖励  def get_award_by_group_id(event_name, uid, group_id)</h3>
<div class="outline-text-3" id="text-8-2">
<ul class="org-ul">
<li>EVENT_AWARD_FORMAT<br></li>
<li>返回 1-领取成功 2-已领取 3-未达成领取条件<br></li>
</ul>
</div>
</div>
<div id="outline-container-org3f43394" class="outline-3">
<h3 id="org3f43394"><span class="section-number-3">8.3</span> 获取优秀信件列表 def get_email_examples(event_name, refresh=False)</h3>
<div class="outline-text-3" id="text-8-3">
<ul class="org-ul">
<li>EVENT_EMAIL_EXAMPLES_FORMAT<br></li>
<li>返回优秀邮件列表 [{"email_id": 123, "uid": "xxx", "t_uid": "xxx", "title": "xxx", "content": "xxx", "ctime": 1582969767}]<br></li>
</ul>
</div>
</div>
<div id="outline-container-org81368f5" class="outline-3">
<h3 id="org81368f5"><span class="section-number-3">8.4</span> 获取该活动中我收到的所有邮件 def get_my_total_emails(event_name, uid, refresh=False)</h3>
<div class="outline-text-3" id="text-8-4">
<ul class="org-ul">
<li>EVENT_MY_EMAILS<br></li>
<li>返回邮件列表 [{"email_id": 123, "uid": "xxx", "t_uid": "xxx", "title": "xxx", "content": "xxx", "ctime": 1582969767, "is_public": 1, "is_anonymous": 1, "read_time": 1582980539}]<br></li>
</ul>
</div>
</div>
<div id="outline-container-org4dba277" class="outline-3">
<h3 id="org4dba277"><span class="section-number-3">8.5</span> 获取邮件详情 def get_the_email_info(email_id, refresh=False)</h3>
<div class="outline-text-3" id="text-8-5">
<ul class="org-ul">
<li>EVENT_EMAIL_INFO_FORMAT<br></li>
<li>返回 {"email_id": 123, "uid": "xxx", "t_uid": "xxx", "event_name": "xxx", "title": "xxx", "content": "xxx", "read_time": 1582969767, "is_public": 1, "is_anonymous": 1, "is_example": 1, "ctime": 1582980539}<br></li>
</ul>
</div>
</div>
<div id="outline-container-org35462b2" class="outline-3">
<h3 id="org35462b2"><span class="section-number-3">8.6</span> 获取未读邮件数量</h3>
</div>
</div>
</div>
<div id="postamble" class="status">
<p>本笔记系统由
    <a href="">时中贺</a> 搭建和维护，使用
    <a href="https://www.gnu.org/software/emacs/">Emacs</a>
    <a href="http://orgmode.org/">Org mode</a> 编辑和构建
    <br />
    email: shi_zhonghe@163.com
</p>
<script src="http://www.langdebuqing.com/css/jquery-2.1.3.min.js"></script>
<script src="http://www.langdebuqing.com/css/main.js"></script>
</div>
</body>
</html>
