<!DOCTYPE html>
<html lang="zh-CN">
<head>
<!-- 2018-11-13 Tue 19:32 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>org-mode 表格</title>
<meta name="generator" content="Org mode">
<meta name="author" content="时中贺">
<link rel="stylesheet" type="text/css" href="http://www.langdebuqing.com/css/style.css" />
<link rel="shortcut icon" href="http://www.langdebuqing.com/images/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="preamble" class="status">
<div id="navbar">
    <ul>
        <li id="site-master"><a href="http://www.langdebuqing.com">浪的不轻</a></li>
        <li><a class="navbar-item" href="http://www.langdebuqing.com/gallery.html">Gallery</a> </li>
        <li><a class="navbar-item" href="http://www.langdebuqing.com/notebooks.html">Notebooks</a> </li>
        <li><a class="navbar-item" href="http://www.langdebuqing.com/links.html">Links</a> </li>
        <li><a class="navbar-item" href="http://www.langdebuqing.com/about.html">About</a> </li>
        <li class="search">
            <form action="http://google.com/search" method="get" accept-charset="utf-8">
                <input type="search" id="search" name="q" autocomplete="off" maxlength="30" placeholder="Search..">
                <input type="hidden" name="q" value="site:www.langdebuqing.com">
            </form>
        </li>
    </ul>
</div>
</div>
<div id="content">
<h1 class="title">org-mode 表格</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org638a530">1. 参考</a></li>
<li><a href="#orgacbb8bc">2. org-mode 表格常用快捷键</a></li>
<li><a href="#org963cfe2">3. 自动计算</a>
<ul>
<li><a href="#org530b552">3.1. 计算单个 cell 值</a></li>
<li><a href="#org9f3a57a">3.2. 批量自动计算</a>
<ul>
<li><a href="#orgf3fb446">3.2.1. 例一：单表 2 个域相乘</a></li>
<li><a href="#orgeb702f6">3.2.2. 例二：对另外一个表列求和</a></li>
<li><a href="#org40c694d">3.2.3. 例三：使用唯一关键字关联 2 张表</a></li>
<li><a href="#org4e10d03">3.2.4. 例四：按照范围进行匹配</a></li>
<li><a href="#org3c29da6">3.2.5. 例五：统计空 cell 数量</a></li>
<li><a href="#org0afbaa0">3.2.6. 例六：根据分数排名</a></li>
<li><a href="#orgc59cf7f">3.2.7. 例七：从原始数据统计频率</a></li>
</ul>
</li>
<li><a href="#orgcff28b0">3.3. 附加模式</a></li>
</ul>
</li>
<li><a href="#orgc2b2673">4. 表格宽度和对齐</a></li>
</ul>
</div>
</div>

<div id="outline-container-org638a530" class="outline-2">
<h2 id="org638a530"><span class="section-number-2">1</span> 参考</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="https://orgmode.org/manual/Tables.html">emacs org-mode 表格官方参考手册</a><br>
</p>

<p>
<a href="https://orgmode.org/worg/org-tutorials/tables.html">Org tutorial for tables</a><br>
</p>

<p>
<a href="https://orgmode.org/worg/org-tutorials/org-lookups.html">Org tutorial on table lookup functions</a><br>
</p>

<p>
<a href="https://orgmode.org/worg/org-symbols.html">org-mode 字符转义</a><br>
</p>

<p>
<a href="http://xuzhengchao.com/reading/orgmode-manual.html">org-mode manual 阅读笔记</a><br>
</p>

<p>
<a href="http://www.zmonster.me/2016/06/03/org-mode-table.html">表格基本操作&amp;公式&amp;绘图</a><br>
</p>
</div>
</div>

<div id="outline-container-orgacbb8bc" class="outline-2">
<h2 id="orgacbb8bc"><span class="section-number-2">2</span> org-mode 表格常用快捷键</h2>
<div class="outline-text-2" id="text-2">
<table>
<caption class="t-above"><span class="table-number">&#34920;1&nbsp;</span> org-mode 表格快捷键</caption>

<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">快捷键</th>
<th scope="col" class="org-left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">C-c &vert; <sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup></td>
<td class="org-left">创建表格；或选中以 , 分割 cell 的表格，使用该快捷键将其转换成表格</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">TAB</td>
<td class="org-left">调整表格，将光标移到下一个区域，必要时新建一行</td>
</tr>

<tr>
<td class="org-left">S-TAB</td>
<td class="org-left">调整表格，将光标移到上一个区域</td>
</tr>

<tr>
<td class="org-left">RET</td>
<td class="org-left">调整表格，将光标移到下一行，必要时会新建一行</td>
</tr>

<tr>
<td class="org-left">C-c C-c</td>
<td class="org-left">调整格式化表格，不移动光标</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">M-LEFT/RIGHT</td>
<td class="org-left">左/右移当前列</td>
</tr>

<tr>
<td class="org-left">M-S-LEFT</td>
<td class="org-left">删除当前列。删除后，之前写的公式中的坐标也会相应发生改变，所以尽量用快捷键删除列，不要手动删。其它快捷键同理</td>
</tr>

<tr>
<td class="org-left">M-S-RIGHT</td>
<td class="org-left">在光标位置左边添加一列</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">M-UP/DOWN</td>
<td class="org-left">上/下移当前行</td>
</tr>

<tr>
<td class="org-left">C-c -</td>
<td class="org-left">在当前行下面添加一个水平线。如果带前缀，则在上面添加一行水平线</td>
</tr>

<tr>
<td class="org-left">C-c RET</td>
<td class="org-left">在当前行下面添加一个水平线。并将光标移动到下一行</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">C-c '</td>
<td class="org-left">将光标移动到表格内某个 cell 中，按该快捷键可编辑该 cell 的内容。支持输入表达式来计算该 cell 值</td>
</tr>

<tr>
<td class="org-left">C-c SPC</td>
<td class="org-left">清空光标下的 cell 的值</td>
</tr>

<tr>
<td class="org-left">M-a</td>
<td class="org-left">移动光标到当前 cell 的开始，或移到上一个 cell 的开始</td>
</tr>

<tr>
<td class="org-left">M-e</td>
<td class="org-left">移动光标到当前 cell 的末尾，或移到下一个 cell 的末尾</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">C-c ^</td>
<td class="org-left">将表排序。当前位置所在的列作为排序的依据。排序在距当前位置最近的两个水平线之间的行（或者整个表）中进行</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">C-c }</td>
<td class="org-left">在 org-mode 显示/隐藏表的行号和列号</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org963cfe2" class="outline-2">
<h2 id="org963cfe2"><span class="section-number-2">3</span> 自动计算</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org530b552" class="outline-3">
<h3 id="org530b552"><span class="section-number-3">3.1</span> 计算单个 cell 值</h3>
<div class="outline-text-3" id="text-3-1">
<p>
操作方法一：<br>
</p>
<ul class="org-ul">
<li>光标位于表格内某个 cell 中，按快捷键 <code>C-c '</code> 进入一个临时 buffer。<br></li>
<li>在其中编辑 <code>@2$4=$2*$3</code> 。然后按快捷键 <code>C-c C-c</code> 退出临时 buffer。<br></li>
<li>按快捷键 <code>C-u C-c C-c</code> 执行表达式。得到最终结果（该例中的第二个表格）<br></li>
</ul>

<p>
操作方法二：<br>
</p>
<ul class="org-ul">
<li>如该例中的第一个表格，在 cell 中直接编辑表达式，按快捷键 <code>C-c C-c</code> 执行这个 cell 中的表达式。得到第二个表格<br></li>
</ul>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #8a8a8a;">#+CAPTION:</span> <span style="color: #8a8a8a;">&#36141;&#33756;&#25903;&#20986;</span>
<span style="color: #00afaf;">|      | &#25968;&#37327;&#65288;&#20844;&#26020;&#65289; | &#21333;&#20215;&#65288;&#20803;&#65289; | &#24635;&#39069;&#65288;&#20803;&#65289; |</span>
<span style="color: #00afaf;">|------+--------------+------------+------------|</span>
<span style="color: #00afaf;">| &#40644;&#29916; |            3 |          3 | </span><span style="color: #d70000; font-weight: bold; font-style: italic;">:=$2*$3    </span><span style="color: #00afaf;">|</span>
<span style="color: #00afaf;">| &#30333;&#33756; |            3 |          4 |            |</span>
<span style="color: #00afaf;">| &#35910;&#33469; |            6 |          2 |            |</span>
<span style="color: #00afaf;">| &#38738;&#26898; |            2 |          1 |            |</span>
<span style="color: #8a8a8a;">#+TBLFM: </span>

<span style="color: #8a8a8a;">#+CAPTION:</span> <span style="color: #8a8a8a;">&#36141;&#33756;&#25903;&#20986;</span>
<span style="color: #00afaf;">|      | &#25968;&#37327;&#65288;&#20844;&#26020;&#65289; | &#21333;&#20215;&#65288;&#20803;&#65289; | &#24635;&#39069;&#65288;&#20803;&#65289; |</span>
<span style="color: #00afaf;">|------+--------------+------------+------------|</span>
<span style="color: #00afaf;">| &#40644;&#29916; |            3 |          3 |          9 |</span>
<span style="color: #00afaf;">| &#30333;&#33756; |            3 |          4 |            |</span>
<span style="color: #00afaf;">| &#35910;&#33469; |            6 |          2 |            |</span>
<span style="color: #00afaf;">| &#38738;&#26898; |            2 |          1 |            |</span>
<span style="color: #8a8a8a;">#+TBLFM: @2$4=$2*$3</span>
</pre>
</div>

<dl class="org-dl">
<dt><code>@2</code></dt><dd>表示第二行当前列<br></dd>
<dt><code>$3</code></dt><dd>表示当前行第三列<br></dd>
<dt><code>:=</code></dt><dd>表示只计算这一项<br></dd>
<dt><code>#+TBLFM</code>:  </dt><dd>在该行添加公式，可通过方法一、方法二间接添加公式到这里，也可以直接在这里写公式<br></dd>
<dt><code>C-c C-c</code>  </dt><dd>光标在某个 cell 中，才能使用该快捷键调用表达式计算该 cell 的值<br></dd>
<dt><code>C-u C-c C-c</code> </dt><dd>计算所有公式<br></dd>
</dl>
</div>
</div>

<div id="outline-container-org9f3a57a" class="outline-3">
<h3 id="org9f3a57a"><span class="section-number-3">3.2</span> 批量自动计算</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-orgf3fb446" class="outline-4">
<h4 id="orgf3fb446"><span class="section-number-4">3.2.1</span> 例一：单表 2 个域相乘</h4>
<div class="outline-text-4" id="text-3-2-1">
<div class="org-src-container">
<pre class="src src-org"><span style="color: #8a8a8a;">#+CAPTION:</span> <span style="color: #8a8a8a;">&#36141;&#33756;&#25903;&#20986;</span>
<span style="color: #00afaf;">|      | &#25968;&#37327;&#65288;&#20844;&#26020;&#65289; | &#21333;&#20215;&#65288;&#20803;&#65289; | &#24635;&#39069;&#65288;&#20803;&#65289; |</span>
<span style="color: #00afaf;">|------+--------------+------------+------------|</span>
<span style="color: #00afaf;">| &#40644;&#29916; |            3 |          3 |          9 |</span>
<span style="color: #00afaf;">| &#30333;&#33756; |            3 |          4 |         12 |</span>
<span style="color: #00afaf;">| &#35910;&#33469; |            6 |          2 |         12 |</span>
<span style="color: #00afaf;">| &#38738;&#26898; |            2 |          1 |          2 |</span>
<span style="color: #8a8a8a;">#+TBLFM: @2$4=$2*$3::@3$4..@5$4=$2*$3</span>
</pre>
</div>

<dl class="org-dl">
<dt><code>#+TBLFM:</code>  </dt><dd>公式间用 <code>::</code> 隔开<br></dd>
<dt><code>@3$4..@5$4</code></dt><dd>表示一个区域。第三行的第四个单元格 —— 第五行的第四个单元格，一共 3 个单元格。它是一个向量<br></dd>
</dl>
</div>
</div>

<div id="outline-container-orgeb702f6" class="outline-4">
<h4 id="orgeb702f6"><span class="section-number-4">3.2.2</span> 例二：对另外一个表列求和</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
这个例子包含了常量的设置、表的远程引用、附加模式的使用、calc 公式、lisp 公式等<br>
</p>

<div class="org-src-container">
<pre class="src src-org">
<span style="color: #8a8a8a;">#+NAME: circle</span>
<span style="color: #8a8a8a;">#+CONSTANTS: pi=3.14</span>
<span style="color: #8a8a8a;">#+CAPTION:</span> <span style="color: #8a8a8a;">&#22278;&#34920;</span>
<span style="color: #00afaf;">|     | &#21322;&#24452; |  &#21608;&#38271; |  &#38754;&#31215; |</span>
<span style="color: #00afaf;">|-----+------+-------+-------|</span>
<span style="color: #00afaf;">| &#22278;1 |    1 |  6.28 |  3.14 |</span>
<span style="color: #00afaf;">| &#22278;2 |    2 | 12.56 | 12.56 |</span>
<span style="color: #00afaf;">| &#22278;3 |    3 | 18.84 | 28.26 |</span>
<span style="color: #8a8a8a;">#+TBLFM: $3=2*$2*$pi</span>
<span style="color: #8a8a8a;">#+TBLFM: $4=$2^2*$pi</span>

<span style="color: #00afaf;">| &#21608;&#38271;&#21644; | &#38754;&#31215;&#21644; |</span>
<span style="color: #00afaf;">|--------+--------|</span>
<span style="color: #00afaf;">|  37.68 |  43.96 |</span>
<span style="color: #8a8a8a;">#+TBLFM: @2$1='(+ remote(circle, @2$3..@&gt;$3));N::@2$2='(+ remote(circle, @2$4..@&gt;$4));N</span>

</pre>
</div>

<dl class="org-dl">
<dt><code>#+NAME:</code></dt><dd>表格唯一标识，可用来标识这个表。比如 <code>remote(circle, @23..@&gt;$3)</code> 就使用了它<br></dd>
<dt><code>#+CONSTANTS:</code></dt><dd>定义局部常量，多个常量可以用空格分割。常量前加 <code>$</code> 即可引用，例如 <code>$pi</code><br></dd>
<dt><code>remote(circle, @2$3..@&gt;$3)</code> </dt><dd>引用表 circle 中的数据，circle 是 <code>#+NAME:</code> 定义的<br></dd>
<dt><code>@&gt;$3</code></dt><dd>最后一行第三列<br></dd>
<dt><code>'(+ remote(circle, @2$3..@&gt;$3));N</code></dt><dd>以 <code>'(</code> 开头的表达式会被解析为 lisp 代码公式而不再是 calc 公式。此时默认情况下，表格中的内容会被当成字符串。如果需要将其处理为数字，就需要在末尾添加 <code>;N</code><br></dd>
<dt><code>;N</code></dt><dd>这是一个<a href="#orgcff28b0">附加模式</a>，附加模式可以用于计算特定格式的内容。公式和附加模式之间用 <code>;</code> 隔开。 <code>;N</code> 表示将表格中的内容处理成数字<br></dd>
</dl>


<p>
其它相关但没用到的知识点：<br>
</p>
<dl class="org-dl">
<dt><code>@#</code>     </dt><dd>当前行的行号<br></dd>
<dt><code>$#</code>     </dt><dd>当前列的列号<br></dd>
<dt><code>@-1$-3</code> </dt><dd>上一行，当前列左边第三列<br></dd>
<dt><code>@0</code>     </dt><dd>当前行<br></dd>
<dt><code>calc 公式</code></dt><dd><code>/</code> 优先级低于 <code>*</code> 。所以公式 <code>$4=$1/$2*$3</code> 实际为 <code>$4=$1/($2*$3)</code> 。公式末尾可以根据需要添加<a href="#orgcff28b0">附加模式</a><br></dd>
<dt><code>lisp 公式</code></dt><dd>以 <code>'(</code> 开头的表达式会被解析为 lisp 公式。在公式末尾根据需要来添加<a href="#orgcff28b0">附加模式</a><br></dd>
</dl>
</div>
</div>

<div id="outline-container-org40c694d" class="outline-4">
<h4 id="org40c694d"><span class="section-number-4">3.2.3</span> 例三：使用唯一关键字关联 2 张表</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
根据汇率批量计算转换币种后的消费<br>
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #8a8a8a;">#+NAME: rates</span>
<span style="color: #00afaf;">| currency        | abbreviation | euros |</span>
<span style="color: #00afaf;">|-----------------+--------------+-------|</span>
<span style="color: #00afaf;">| euro            | eur          |     1 |</span>
<span style="color: #00afaf;">| Norwegian krone | nok          |  0.14 |</span>
<span style="color: #00afaf;">| Swedish krona   | sek          |  0.12 |</span>
<span style="color: #00afaf;">| US dollar       | usd          |  0.77 |</span>

<span style="color: #8a8a8a;">#+NAME: cost</span>
<span style="color: #00afaf;">|  date | expense          |  sum | currency | rate |   euros |</span>
<span style="color: #00afaf;">|-------+------------------+------+----------+------+---------|</span>
<span style="color: #00afaf;">|  1.3. | flights          |  324 | eur      |    1 |     324 |</span>
<span style="color: #00afaf;">|  4.6. | books and maps   |  243 | usd      | 0.77 |  187.11 |</span>
<span style="color: #00afaf;">| 30.7. | rental car       | 8300 | sek      | 0.12 |    996. |</span>
<span style="color: #00afaf;">|  2.7. | hotel            | 1150 | sek      | 0.12 |    138. |</span>
<span style="color: #00afaf;">|  2.7. | lunch            |  190 | sek      | 0.12 |    22.8 |</span>
<span style="color: #00afaf;">|  3.7. | fishing licenses | 1400 | nok      | 0.14 |    196. |</span>
<span style="color: #00afaf;">|  3.7. | gasoline         |  340 |          |  nil | 340 nil |</span>
<span style="color: #8a8a8a;">#+TBLFM: $5='(org-lookup-first $4 '(remote(rates,@2$2..@&gt;$2)) '(remote(rates,@2$3..@&gt;$3)))::$6=$5*$3</span>
</pre>
</div>

<dl class="org-dl">
<dt><code>'(org-lookup-first $4 '(remote(rates,@2$2..@&gt;$2)) '(remote(rates,@2$3..@&gt;$3)))</code></dt><dd><code>org-lookup-first</code> 函数原型为 <code>(org-lookup-first VAL S-LIST R-LIST &amp;optional PREDICATE)</code> 。它表示在 rates 表的第二列查找和 cost 表的第四列当前行相同的元素，找到第一个匹配的元素就返回，返回值是该元素所在行对应的第三列的元素值<br></dd>
<dt><code>(org-lookup-first VAL S-LIST R-LIST &amp;optional PREDICATE)</code></dt><dd>查找列表 S-LIST 中和 VAL 相同（当断言参数 PREDICATE 省略时，默认为等于号）的第一个元素，找到后，返回该元素所在行对应在列表 R-LIST 上的元素<br></dd>
</dl>
</div>
</div>

<div id="outline-container-org4e10d03" class="outline-4">
<h4 id="org4e10d03"><span class="section-number-4">3.2.4</span> 例四：按照范围进行匹配</h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
批量计算学生的分数级别<br>
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #8a8a8a;">#+TBLNAME: grade-boundaries</span>
<span style="color: #00afaf;">| lower bound | grade |</span>
<span style="color: #00afaf;">|-------------+-------|</span>
<span style="color: #00afaf;">|           0 | F     |</span>
<span style="color: #00afaf;">|          10 | D     |</span>
<span style="color: #00afaf;">|          20 | C     |</span>
<span style="color: #00afaf;">|          30 | B     |</span>
<span style="color: #00afaf;">|          40 | A     |</span>

<span style="color: #00afaf;">| student | marks | grade |</span>
<span style="color: #00afaf;">|---------+-------+-------|</span>
<span style="color: #00afaf;">| X       |    30 | B     |</span>
<span style="color: #00afaf;">| Y       |    29 | C     |</span>
<span style="color: #00afaf;">| Z       |     5 | F     |</span>
<span style="color: #00afaf;">| W       |    55 | A     |</span>
<span style="color: #8a8a8a;">#+TBLFM: $3='(org-lookup-last $2 '(remote(grade-boundaries,@2$1..@&gt;$1)) '(remote(grade-boundaries,@2$2..@&gt;$2)) '&gt;=);L</span>
</pre>
</div>

<dl class="org-dl">
<dt><code>;L</code> </dt><dd>因为公式中需要用的表的元素值有些是数字，有些值是符号。所以要使用 <code>L</code><br></dd>
<dt><code>(org-lookup-last VAL S-LIST R-LIST &amp;optional PREDICATE)</code> </dt><dd>查找列表 S-LIST 中最后一个大于等于（当断言参数 PREDICATE 为 <code>&gt;=</code> 时） VAL 的元素，找到后，返回该元素所在行对应在列表 R-LIST 上的元素<br></dd>
</dl>
</div>
</div>

<div id="outline-container-org3c29da6" class="outline-4">
<h4 id="org3c29da6"><span class="section-number-4">3.2.5</span> 例五：统计空 cell 数量</h4>
<div class="outline-text-4" id="text-3-2-5">
<div class="org-src-container">
<pre class="src src-org"><span style="color: #00afaf;">| group | round 1 | round 2 |</span>
<span style="color: #00afaf;">|-------+---------+---------|</span>
<span style="color: #00afaf;">| A     |         |     2.4 |</span>
<span style="color: #00afaf;">| B     |     4.7 |      11 |</span>
<span style="color: #00afaf;">| C     |         |         |</span>
<span style="color: #00afaf;">| D     |       5 |         |</span>
<span style="color: #00afaf;">| E     |         |     7.2 |</span>
<span style="color: #00afaf;">| F     |     3.2 |     4.3 |</span>
<span style="color: #00afaf;">| G     |         |     4.4 |</span>
<span style="color: #00afaf;">| H     |         |       8 |</span>
<span style="color: #00afaf;">|-------+---------+---------|</span>
<span style="color: #00afaf;">| total | missing |       7 |</span>
<span style="color: #8a8a8a;">#+TBLFM: @&gt;$3='(length(org-lookup-all "" '(@2$2..@-1$3) nil));E</span>
</pre>
</div>

<dl class="org-dl">
<dt><code>'(@2$2..@-1$3)</code> </dt><dd>因为上面的完整的公式要计算的是 <code>@&gt;$3</code> 的值，也就是 <code>@10$3</code> 的值。所以在这里，=@-1= 就相当于 <code>@9$3</code> 。<br></dd>
<dt><code>(org-lookup-all VAL S-LIST R-LIST &amp;optional PREDICATE)</code> </dt><dd>在 S-LIST 查找所有匹配的元素，返回元素对应的位置在 R-LIST 的值。如果 R-LIST 是空，直接返回 S-LIST 中匹配到的项。断言 PREDICATE 省略表示默认为等于号<br></dd>
<dt><code>;E</code> </dt><dd>表示在表格域的范围中保留空域<br></dd>
<dt><code>length</code> </dt><dd>计算列表长度<br></dd>
</dl>
</div>
</div>

<div id="outline-container-org0afbaa0" class="outline-4">
<h4 id="org0afbaa0"><span class="section-number-4">3.2.6</span> 例六：根据分数排名</h4>
<div class="outline-text-4" id="text-3-2-6">
<div class="org-src-container">
<pre class="src src-org"><span style="color: #00afaf;">| group | marks | rank |</span>
<span style="color: #00afaf;">|-------+-------+------|</span>
<span style="color: #00afaf;">| A     |    22 |    2 |</span>
<span style="color: #00afaf;">| B     |    22 |    2 |</span>
<span style="color: #00afaf;">| C     |    14 |    4 |</span>
<span style="color: #00afaf;">| D     |    28 |    1 |</span>
<span style="color: #00afaf;">| E     |     9 |    5 |</span>
<span style="color: #8a8a8a;">#+TBLFM: $3='(+ 1 (length (org-lookup-all $2 '(@2$2..@&gt;$2) nil '&lt;)));N</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc59cf7f" class="outline-4">
<h4 id="orgc59cf7f"><span class="section-number-4">3.2.7</span> 例七：从原始数据统计频率</h4>
<div class="outline-text-4" id="text-3-2-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #8a8a8a;">;; </span><span style="color: #8a8a8a;">bounds &#26159;&#21547;&#26377; 2 &#20010;&#20803;&#32032;&#30340;&#21015;&#34920;&#65292;&#34920;&#31034;&#21462;&#20540;&#33539;&#22260;&#12290;&#20363;&#22914; (1 1.9)&#12290;&#29992; (a b) &#34920;&#31034;</span>
<span style="color: #8a8a8a;">;; </span><span style="color: #8a8a8a;">el &#26159;&#19968;&#20010;&#25968;&#20540;</span>
<span style="color: #8a8a8a;">;; </span><span style="color: #8a8a8a;">&#35813;&#20989;&#25968;&#29992;&#20110;&#21028;&#26029; el &#26159;&#21542;&#22312;&#21306;&#38388; [a, b] &#20869;</span>
<span style="color: #8a8a8a;">;; </span><span style="color: #8a8a8a;">car &#20989;&#25968;&#36820;&#22238;&#21015;&#34920;&#30340;&#31532;&#19968;&#20010;&#20803;&#32032;</span>
<span style="color: #8a8a8a;">;; </span><span style="color: #8a8a8a;">cadr &#20989;&#25968;&#21024;&#38500;&#21015;&#34920;&#30340;&#31532;&#19968;&#20010;&#20803;&#32032;&#65292;&#24182;&#36820;&#22238;&#32467;&#26524;&#21015;&#34920;&#30340;&#31532;&#19968;&#20010;&#20803;&#32032;</span>
(<span style="color: #5f8700;">defun</span> <span style="color: #0087ff;">in-interval</span> (bounds el)
  (<span style="color: #5f8700;">and</span> (&gt;= el (car bounds)) (&lt;= el (cadr bounds))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #8a8a8a;">#+TBLNAME: raw-data</span>
<span style="color: #00afaf;">| group | result |</span>
<span style="color: #00afaf;">|-------+--------|</span>
<span style="color: #00afaf;">| A     |    2.3 |</span>
<span style="color: #00afaf;">| B     |    4.2 |</span>
<span style="color: #00afaf;">| C     |    1.1 |</span>
<span style="color: #00afaf;">| D     |    3.6 |</span>
<span style="color: #00afaf;">| E     |    4.5 |</span>
<span style="color: #00afaf;">| F     |    2.4 |</span>
<span style="color: #00afaf;">| G     |    1.0 |</span>
<span style="color: #00afaf;">| H     |    2.3 |</span>
<span style="color: #00afaf;">| I     |    2.8 |</span>

<span style="color: #00afaf;">| lower bound | upper bound | frequency |</span>
<span style="color: #00afaf;">|-------------+-------------+-----------|</span>
<span style="color: #00afaf;">|           1 |         1.9 |         2 |</span>
<span style="color: #00afaf;">|           2 |         2.9 |         4 |</span>
<span style="color: #00afaf;">|           3 |         3.9 |         1 |</span>
<span style="color: #00afaf;">|           4 |         4.9 |         2 |</span>
<span style="color: #8a8a8a;">#+TBLFM: $3='(length (org-lookup-all '($1 $2) '(remote(raw-data,@2$2..@&gt;$2)) nil 'in-interval));N</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgcff28b0" class="outline-3">
<h3 id="orgcff28b0"><span class="section-number-3">3.3</span> 附加模式</h3>
<div class="outline-text-3" id="text-3-3">
<p>
附件模式可以用于计算特定格式的内容, 或者格式化数据. org 支持公式后面添加任意数量的附加模式, 公式和附加模式之间用";"隔开. 目前支持的附加模式包括:<br>
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">附加模式</th>
<th scope="col" class="org-left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">pN</td>
<td class="org-left">计算精度。</td>
</tr>

<tr>
<td class="org-left">nN/sN/eN/fN</td>
<td class="org-left">设置结果输出格式。n3 表示输出 3 位有效数字；s3 输出结果为科学计数法，3位有效数字(1.45e0)；e3: 输出结果为工程计数法，3位有效数字(0.145e1)；f3: 输出结果精确至小数点后3位</td>
</tr>

<tr>
<td class="org-left">D/R</td>
<td class="org-left">计算时使用角度制还是弧度制(如三角函数)</td>
</tr>

<tr>
<td class="org-left">F/S</td>
<td class="org-left">分数还是符号(当为 S 时，若结果不为整数，则显示式子本身，如: sqrt(6))</td>
</tr>

<tr>
<td class="org-left">T/t</td>
<td class="org-left">时间计算，要求用于计算的值是"HH:MM[:SS]"的形式，当使用 T 时，输出结果是 "HH:MM:SS" 形式；使用 "t" 时，结果显示为一个数值，默认情况下单位是小时，可以通过变量 org-table-duration-custome-format 来设置</td>
</tr>

<tr>
<td class="org-left">E</td>
<td class="org-left">不使用时，所有空白单元格都会被跳过，不会包含在计算过程中;当使用时，如果还使用了 N ，则用 "0" 填充；否则，在普通公式中，用 "nan" 填充，在 emacs lisp 公式中，用空字符串填充</td>
</tr>

<tr>
<td class="org-left">N</td>
<td class="org-left">使用时，将所有域的值视为数字，对于非数值型，用 0 替代</td>
</tr>

<tr>
<td class="org-left">L</td>
<td class="org-left">只用于 emacs lisp 公式，后续</td>
</tr>
</tbody>
</table>

<p>
例如：<br>
</p>
<dl class="org-dl">
<dt><code>$1+$2;%.2f</code>     </dt><dd>保留 2 位小数<br></dd>
<dt><code>tan($1);Dp3s1</code>  </dt><dd>参数单位为度，计算精度为 3，科学表示<br></dd>
</dl>
</div>
</div>
</div>


<div id="outline-container-orgc2b2673" class="outline-2">
<h2 id="orgc2b2673"><span class="section-number-2">4</span> 表格宽度和对齐</h2>
<div class="outline-text-2" id="text-4">
<dl class="org-dl">
<dt><code>&lt;l&gt;</code> <code>&lt;r&gt;</code></dt><dd>左对齐和右对齐<br></dd>
<dt><code>&lt;16&gt;</code></dt><dd>本列宽度最大为 16。宽度和对齐标记可以结合起来写<br></dd>
</dl>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #00afaf;">|      | &#25968;&#37327;&#65288;&#20844;&#26020;&#65289;     | &#21333;&#20215;&#65288;&#20803;&#65289; | &#24635;&#39069;&#65288;&#20803;&#65289; |</span>
<span style="color: #00afaf;">|------+------------------+------------+------------|</span>
<span style="color: #00afaf;">|      | </span><span style="color: #d70000; font-weight: bold; font-style: italic;">&lt;l16&gt;</span><span style="color: #00afaf;">            |      </span><span style="color: #d70000; font-weight: bold; font-style: italic;">&lt;r10&gt;</span><span style="color: #00afaf;"> |            |</span>
<span style="color: #00afaf;">| &#40644;&#29916; | 3                |          3 |            |</span>
<span style="color: #00afaf;">| &#30333;&#33756; | 3                |          4 |            |</span>
<span style="color: #00afaf;">| &#35910;&#33469; | 6                |          2 |            |</span>
<span style="color: #00afaf;">| &#38738;&#26898; | 2                |          1 |            |</span>
</pre>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">&#33050;&#27880;: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
表格中输出竖线 &vert;，需要在 org 表格中输入 <code>\vert</code> 。如果需要输出 <code>\vert</code> ，可以在 org 文档中输入 <code>=\vert=</code> 或 <code>~\vert~</code><br>
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p>本笔记系统由
    <a href="">时中贺</a> 搭建和维护，使用
    <a href="https://www.gnu.org/software/emacs/">Emacs</a>
    <a href="http://orgmode.org/">Org mode</a> 编辑和构建
    <br />
    email: shi_zhonghe@163.com
</p>
<script src="http://www.langdebuqing.com/css/jquery-2.1.3.min.js"></script>
<script src="http://www.langdebuqing.com/css/main.js"></script>
</div>
</body>
</html>
